---
title: "assembly_analysis"
output: html_document
date: "`r Sys.Date()`"
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(dplyr)
library(ggplot2)
```

## Window plot

Create a plot of 1mb windows across the genome, with the quantity of features within each window.

```{r windows}
gc <- read.table("../results/windows/gc.bed") %>%
  select(V1, V2, V3, V5) %>%
  rename(chrom = "V1", start = "V2", end = "V3", prop = "V5") %>%
  mutate(feature = "gc")

genes <- read.table("../results/windows/genes.bed") %>%
  select(V1, V2, V3, V7) %>%
  rename(chrom = "V1", start = "V2", end = "V3", prop = "V7") %>%
  mutate(feature = "gene")

copia <- read.table("../results/windows/copia.bed") %>%
  select(V1, V2, V3, V7) %>%
  rename(chrom = "V1", start = "V2", end = "V3", prop = "V7") %>%
  mutate(feature = "copia")
  
gypsy <- read.table("../results/windows/gypsy.bed") %>%
  select(V1, V2, V3, V7) %>%
  rename(chrom = "V1", start = "V2", end = "V3", prop = "V7") %>%
  mutate(feature = "gypsy")
  
tir <- read.table("../results/windows/tir.bed") %>%
  select(V1, V2, V3, V7) %>%
  rename(chrom = "V1", start = "V2", end = "V3", prop = "V7") %>%
  mutate(feature = "tir")
  
helitron <- read.table("../results/windows/helitron.bed") %>%
  select(V1, V2, V3, V7) %>%
  rename(chrom = "V1", start = "V2", end = "V3", prop = "V7") %>%
  mutate(feature = "helitron")

merged <- rbind(gc, genes, copia, gypsy, tir, helitron)

ggplot(merged, aes(xmin = start, xmax = end, ymin = 0, ymax = prop, fill = prop)) +
  geom_rect() +
  facet_grid(feature ~ chrom, scales = "free")
```